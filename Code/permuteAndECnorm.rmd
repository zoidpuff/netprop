---
title: "Untitled"
output: github_document
---

```{r setup, include=FALSE}
netPropPath <- '/home/gummi/netprop'
library(igraph)
library(dplyr)
source(paste0(netPropPath, '/Code/NetPropFuncs.R'))
if(file.exists(paste0(netPropPath,"/data/intGraph.rdata"))){
    load(paste0(netPropPath,"/data/intGraph.rdata"))
} 

```

```{r }
seedVector <- rep(1, vcount(intGraph))

ECvec <- igraph::page_rank(intGraph, directed = FALSE, damping = 1, personalized = seedVector,algo="arpack")

assocDataBySourceDirectFiltered <- read.csv(paste0(netPropPath,"/data/associationByDatasourceDirectFiltered.csv"), stringsAsFactors = FALSE)
assocDataBySourceDirIndiMergedFiltered <- read.csv(paste0(netPropPath,"/data/associationByDatasourceDirIndirMergedFiltered.csv"), stringsAsFactors = FALSE)

seedVecsDirect <- runNetProp(network = intGraph,
                    assocData = assocDataBySourceDirectFiltered,
                    cutoff = c("value" = 0.5, "number" = 5),
                    binarize = TRUE,
                    damping = 0.85,
                    NormFunc = NULL,
                    settingsForNormFunc = NULL,
                    returnSeedVec = TRUE)

<- rowSums(seedVecsDirect)

```

```{r }

# Compute average network propagation vector by using random seeds and compare the distance to the EC vector for every iteration 

nIter <- 100

avgVec <- rep(1/vcount(intGraph), vcount(intGraph))

distanceVec <- rep(0, nIter)

for(i in 1:nIter){
    seedVector <- rep(0, vcount(intGraph))
    seedVector[sample(1:vcount(intGraph), abs(ceiling(rnorm(1,150,50))))] <- 1	
    
    tempVec <- igraph::page_rank(intGraph,directed = FALSE, personalized = seedVector)$vector 

    # Update the average vector
    avgVec <- avgVec + (tempVec - avgVec)/i

    # Compute the distance between the EC vector and the average vector
    distanceVec[i] <- as.numeric(dist(rbind(avgVec, ECvec$vector), method = "manhattan"))
    print(distanceVec[i])

}


```

```{r }

seedVec <- rep(1/vcount(intGraph), vcount(intGraph))

nIter <- 100

for(i in seq(0.01,0.99,0.01)){
    
    res <- igraph::page_rank(intGraph, damping = i,directed = FALSE, personalized = seedVector)$vector 

    # Compute the distance between the EC vector and the average vector
    distanceVec[i*100] <- as.numeric(dist(rbind(res, ECvec$vector), method = "manhattan"))
    print(distanceVec[i*100])

}


```